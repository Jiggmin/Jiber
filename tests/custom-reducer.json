{
    "INIT": [
        ["CHECK", "users.length", "==", 2],
        ["CHECK", "state._initialized", "!=", true],
        ["SET", "state._initialized", true],
        ["SET", "state._deck", [
            1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
            1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
            1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
            1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
            13, 13
        ]],
        ["SHUFFLE", "state._deck"],
        ["SPLICE", "state._deck", 0, 5, "users[0]._hand"],
        ["SPLICE", "state._deck", 0, 5, "users[1]._hand"]
    ],
    "PLAY_CARD": [
        ["CHECK", "user._hiddenCard", "^=", false],
        ["CHECK", "user._hand.length", ">=", "action.cardIndex"],
        ["SPLICE", "user._hand", "action.cardIndex", 1, "user._hiddenCard"],
        ["SET", "user.hasSelectedCard", true],
        ["GOTO", "_CHURN"]
    ],
    "_CHURN": [
        ["CHECK", "users[0]._hiddenCard", "^=", true],
        ["CHECK", "users[1]._hiddenCard", "^=", true],
        ["SLEEP", 1000],
        ["GOTO", "_REVEAL_CARDS"],
        ["SLEEP", 1000],
        ["GOTO", "_BATTLE"],
        ["SLEEP", 1000],
        ["GOTO", "_END_GAME"]
    ],
    "_REVEAL_CARDS": [
        ["SET", "users[0].revealedCard", "users[0]._hiddenCard"],
        ["SET", "users[1].revealedCard", "users[1]._hiddenCard"],
        ["SET", "users[0].hiddenCard", null],
        ["SET", "users[1].hiddenCard", null],
        ["SET", "users[0].hasSelectedCard", false],
        ["SET", "users[1].hasSelectedCard", false]
    ],
    "_BATTLE": [
        ["IF", "users[0].revealedCard", ">", "users[1].revealedCard", [
            ["ADD", "users[0].points", 1]
        ]],
        ["IF", "users[0].revealedCard", "<", "users[1].revealedCard", [
            ["ADD", "users[1].points", 1]
        ]],
        ["SET", "users[0].revealedCard", null],
        ["SET", "users[1].revealedCard", null]
    ],
    "_END_GAME": [
        ["CHECK", "users[0].hand.length", "==", 0],
        ["CHECK", "users[1].hand.length", "==", 0],
        ["IF", "users[0].points", ">", "users[1].points", [
            ["SET", "state.winner", "users[0].id"]
        ]],
        ["IF", "users[0].points", "<", "users[1].points", [
            ["SET", "state.winner", "users[1].id"]
        ]],
        ["IF", "users[0].points", "==", "users[1].points", [
            ["SET", "state.winner", "tie"]
        ]]
    ]
}